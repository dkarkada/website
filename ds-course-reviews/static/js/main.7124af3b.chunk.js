(this["webpackJsonpds-course-reviews"]=this["webpackJsonpds-course-reviews"]||[]).push([[0],{19:function(e,t,a){e.exports=a(30)},24:function(e,t,a){},29:function(e,t,a){},30:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(16),o=a.n(s),i=(a(24),a(2)),l=a.n(i),c=a(13),u=a(5),m=a(11),h=a(6),d=a(7),p=a(8),f=a(10),v=a(9),w=a(12),g=a(18),y=a(17),E=a.n(y),k=a(3);a(29);function b(){return S.apply(this,arguments)}function S(){return(S=Object(w.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./api.config").then((function(e){return e.json()})).then((function(e){return e.key}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C,I="https://www.googleapis.com/auth/spreadsheets",R="1AJO52gUTAElYGcfGMK07YkEfWdYNEITkjzS8hhOFTww";function N(e){var t=e.toLowerCase().split(/\s+/);if(t.length>=2){var a=t[0],r=parseInt(t[1]);return isNaN(r)?0:"spring"==a?r+.1:"summer"==a?r+.2:"fall"==a?r+.3:r+.4}return 0}function x(e){var t=e.reviewer?n.a.createElement("p",null,n.a.createElement("b",null,"Reviewer: "),e.reviewer):null,a=e.misc?n.a.createElement("p",null,n.a.createElement("b",null,"Miscellaneous: "),e.misc):null;return n.a.createElement("div",{className:"review"},n.a.createElement("h2",null,e.coursenum," ",e.coursename," ",n.a.createElement("br",null),"Prof. ",e.prof,", ",e.date),t,n.a.createElement("p",null,n.a.createElement("b",null,"Difficulty: "),e.difficulty),n.a.createElement("p",null,n.a.createElement("b",null,"Workload: "),e.workload),n.a.createElement("p",null,n.a.createElement("b",null,"Lectures: "),e.lecture),a)}var M=function(e){Object(f.a)(a,e);var t=Object(v.a)(a);function a(e){var r;Object(d.a)(this,a),r=t.call(this,e);var n,s=new Map,o=new Map,i=new Map,l=Object(h.a)(e.reviews);try{for(l.s();!(n=l.n()).done;){var c=n.value,u=c.dept;s.has(u)?s.get(u).push(c):s.set(u,[c]);var m=c.coursenum;o.has(m)?o.get(m).push(c):o.set(m,[c]);var p=c.prof;i.has(p)?i.get(p).push(c):i.set(p,[c])}}catch(f){l.e(f)}finally{l.f()}return r.allDeptNames=s,r.allCoursenums=o,r.allProfs=i,r.deptList=Array.from(r.allDeptNames.keys()).sort(),r.state={dept:"",course:"",prof:"",search:"",availProfs:Array.from(r.allProfs.keys()).sort(),availCourses:Array.from(r.allCoursenums.keys()).sort(),availReviews:r.props.reviews,numRevShown:20},r}return Object(p.a)(a,[{key:"deptChange",value:function(e){var t=this;this.setState({dept:e.target.value,course:"",prof:""}),this.setState((function(e){return t.updateReviews(e)}))}},{key:"courseChange",value:function(e){var t=this;if(""==this.state.dept){var a=this.allCoursenums.get(e.target.value)[0].dept;this.setState({dept:a,course:e.target.value})}else this.setState({course:e.target.value});this.setState((function(e){return t.updateReviews(e)}))}},{key:"profChange",value:function(e){var t=this;if(""==this.state.dept){var a=this.allProfs.get(e.target.value)[0].dept;this.setState({dept:a,prof:e.target.value})}else this.setState({prof:e.target.value});this.setState((function(e){return t.updateReviews(e)}))}},{key:"searchChange",value:function(e){var t=this;this.setState({search:e.target.value}),this.setState((function(e){return t.updateReviews(e)}))}},{key:"matches",value:function(e,t){return t=t.toLowerCase(),e.coursename.toLowerCase().includes(t)||e.prof.toLowerCase().includes(t)||e.reviewer.toLowerCase().includes(t)}},{key:"updateReviews",value:function(e){var t,a,r=this,n=this.props.reviews;return""==e.dept?(t=Array.from(this.allCoursenums.keys()).sort(),a=Array.from(this.allProfs.keys()).sort()):(t=(n=this.allDeptNames.get(e.dept)).filter((function(t){return""==e.prof||t.prof==e.prof})).map((function(e){return e.coursenum})),a=n.filter((function(t){return""==e.course||t.coursenum==e.course})).map((function(e){return e.prof})),t=Array.from(new Set(t)).sort(),a=Array.from(new Set(a)).sort()),{availCourses:t,availProfs:a,availReviews:n=n.filter((function(t){return(""==e.prof||t.prof==e.prof)&&(""==e.course||t.coursenum==e.course)&&(""==e.search||r.matches(t,e.search))})),numRevShown:20}}},{key:"loadMoreReviews",value:function(){this.state.numRevShown+20<this.state.availReviews.length?this.setState((function(e){return{numRevShown:e.numRevShown+20}})):this.setState((function(e){return{numRevShown:e.availReviews.length}}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"review-reader"},n.a.createElement("select",{className:"selector",value:this.state.dept,onChange:this.deptChange.bind(this)},n.a.createElement("option",{key:"",value:""}," [All departments] "),this.deptList.map((function(e){return n.a.createElement("option",{key:e},e)}))),n.a.createElement("select",{className:"selector",value:this.state.course,onChange:this.courseChange.bind(this)},n.a.createElement("option",{key:"",value:""}," [All courses] "),this.state.availCourses.map((function(e){return n.a.createElement("option",{key:e},e)}))),n.a.createElement("select",{className:"selector",value:this.state.prof,onChange:this.profChange.bind(this)},n.a.createElement("option",{key:"",value:""}," [All professors] "),this.state.availProfs.map((function(e){return n.a.createElement("option",{key:e},e)}))),n.a.createElement("input",{className:"selector",type:"text",placeholder:"Course name search",onChange:this.searchChange.bind(this)}),n.a.createElement(E.a,{pageStart:0,loadMore:this.loadMoreReviews.bind(this),hasMore:this.state.availReviews.length!=this.state.numRevShown,loader:n.a.createElement("div",{className:"loader",key:0},"Loading ...")},this.state.availReviews.slice(0,this.state.numRevShown).map((function(e){return n.a.createElement(x,Object.assign({key:e.reviewID},e))}))))}}]),a}(n.a.Component),A=function(e){Object(f.a)(a,e);var t=Object(v.a)(a);function a(e){var r;Object(d.a)(this,a),(r=t.call(this,e)).allDepts=Array.from(new Set(e.reviews.map((function(e){return e.dept})))).sort(),r.allProfs=Array.from(new Set(e.reviews.map((function(e){return e.prof})))).sort(),r.allCourseNames=Array.from(new Set(e.reviews.map((function(e){return e.coursename})))).sort();var n,s=new Map,o=Object(h.a)(e.reviews);try{for(o.s();!(n=o.n()).done;){var i=n.value,l=i.dept;s.has(l)?(s.get(l).profs.add(i.prof),s.get(l).coursenames.add(i.coursename)):s.set(l,{profs:new Set([i.prof]),coursenames:new Set([i.coursename])})}}catch(k){o.e(k)}finally{o.f()}s.forEach((function(e,t,a){a.set(t,{profs:Array.from(e.profs).sort(),coursenames:Array.from(e.coursenames).sort()})})),r.deptMap=s;var c=new Date;r.dates=[];for(var u=c.getMonth()+1,p=c.getFullYear(),f=0;f<12;f++)u>8||u<2?(r.dates.push("Fall ".concat(p)),u=8):u>6?(r.dates.push("Summer ".concat(p)),u=6):(r.dates.push("Spring ".concat(p)),u=10,p-=1);var v,w,g={reviewerInp:"",deptSelect:"",coursenumInp:"",coursenameInp:"",profInp:"",dateSelect:r.dates[0],difficultyBox:"",workloadBox:"",lectureBox:"",miscBox:""};for(var y in g)localStorage.getItem(y)&&(g[y]=localStorage.getItem(y));var E=g.deptSelect;return""==E?(v=r.allProfs,w=r.allCourseNames):(v=Array.from(r.deptMap.get(E).profs),w=Array.from(r.deptMap.get(E).coursenames)),r.state=Object(m.a)({availProfs:v,availCourseNames:w},g),r}return Object(p.a)(a,[{key:"deptChange",value:function(e){var t=e.target.value;this.setState({availProfs:Array.from(this.deptMap.get(t).profs),availCourseNames:Array.from(this.deptMap.get(t).coursenames)}),this.inputChangeHandler(e)}},{key:"inputChangeHandler",value:function(e){this.setState(Object(u.a)({},e.target.id,e.target.value)),localStorage.setItem(e.target.id,e.target.value)}},{key:"submitReview",value:function(){var e=this,t={dept:this.state.deptSelect.trim(),coursenum:this.state.coursenumInp.trim(),coursename:this.state.coursenameInp.trim(),prof:this.state.profInp.trim(),date:this.state.dateSelect.trim(),datenum:N(this.state.dateSelect.trim()),difficulty:this.state.difficultyBox.trim(),workload:this.state.workloadBox.trim(),lecture:this.state.lectureBox.trim(),misc:this.state.miscBox.trim(),reviewer:this.state.reviewerInp.trim()},a={values:[[t.coursenum,t.coursename,t.prof,t.date,t.difficulty,t.workload,t.lecture,t.misc,t.reviewer]]},r={spreadsheetId:R,range:this.state.deptSelect,valueInputOption:"USER_ENTERED",insertDataOption:"INSERT_ROWS"};window.gapi.client.load("sheets","v4",(function(){window.gapi.client.sheets.spreadsheets.values.append(r,a).then((function(){var a={reviewerInp:"",deptSelect:"",coursenumInp:"",coursenameInp:"",profInp:"",dateSelect:e.dates[0],difficultyBox:"",workloadBox:"",lectureBox:"",miscBox:""};for(var r in a)localStorage.removeItem(r);var n=e.allProfs,s=e.allCourseNames;e.setState(Object(m.a)({availProfs:n,availCourseNames:s},a)),e.props.updateReviews(t)}),(function(e){alert("Sorry! Not sure why, but the review could not be sent. Try again later?"),console.error("error: "+e.result.error.message)}))}))}},{key:"onSubmit",value:function(){var e=this;""!=this.state.deptSelect&&""!=this.state.coursenumInp&&""!=this.state.coursenameInp&&""!=this.state.profInp&&""!=this.state.dateSelect?C.currentUser.get().hasGrantedScopes(I)?this.submitReview():C.signIn().then((function(){e.submitReview()})):alert("Please fill out all required fields.")}},{key:"render",value:function(){return n.a.createElement("div",{className:"review-writer"},n.a.createElement("label",{htmlFor:"reviewerInp"},"Reviewer (optional): "),n.a.createElement("input",{className:"selector",id:"reviewerInp",onChange:this.inputChangeHandler.bind(this),value:this.state.reviewerInp}),n.a.createElement("label",{htmlFor:"deptSelect"},"*Department: "),n.a.createElement("select",{id:"deptSelect",className:"selector",required:!0,onChange:this.deptChange.bind(this),value:this.state.deptSelect},n.a.createElement("option",{disabled:!0}),this.allDepts.map((function(e){return n.a.createElement("option",{key:e},e)}))),n.a.createElement("label",{htmlFor:"coursenumInp"},"*Course number (e.g. UGS 303): "),n.a.createElement("input",{className:"selector",id:"coursenumInp",required:!0,onChange:this.inputChangeHandler.bind(this),value:this.state.coursenumInp}),n.a.createElement("label",{htmlFor:"coursenameInp"},"*Course name: "),n.a.createElement("input",{className:"selector",id:"coursenameInp",required:!0,list:"coursename",onChange:this.inputChangeHandler.bind(this),value:this.state.coursenameInp}),n.a.createElement("datalist",{id:"coursename"},this.state.availCourseNames.map((function(e){return n.a.createElement("option",{key:e,value:e})}))),n.a.createElement("label",{htmlFor:"profInp"},"*Professor (last name): "),n.a.createElement("input",{className:"selector",id:"profInp",required:!0,list:"prof",onChange:this.inputChangeHandler.bind(this),value:this.state.profInp}),n.a.createElement("datalist",{id:"prof"},this.state.availProfs.map((function(e){return n.a.createElement("option",{key:e,value:e})}))),n.a.createElement("label",{htmlFor:"dateSelect"},"*Date taken: "),n.a.createElement("select",{id:"dateSelect",className:"selector",required:!0,onChange:this.inputChangeHandler.bind(this),value:this.state.dateSelect},this.dates.map((function(e){return n.a.createElement("option",{key:e},e)}))),n.a.createElement("label",{htmlFor:"difficultyBox"},"Difficulty: "),n.a.createElement(k.a,{id:"difficultyBox",style:{width:"90%",resize:"none"},minRows:5,maxRows:15,placeholder:"How hard are the concepts/workload? Is it hard to get a good grade? Etc.",className:"selector",onChange:this.inputChangeHandler.bind(this),value:this.state.difficultyBox}),n.a.createElement("label",{htmlFor:"workloadBox"},"Workload: "),n.a.createElement(k.a,{id:"workloadBox",style:{width:"90%",resize:"none"},minRows:5,maxRows:15,placeholder:"What types of assignments are there? How many hours a week do they take? Etc.",className:"selector",onChange:this.inputChangeHandler.bind(this),value:this.state.workloadBox}),n.a.createElement("label",{htmlFor:"lectureBox"},"Lectures: "),n.a.createElement(k.a,{id:"lectureBox",style:{width:"90%",resize:"none"},minRows:5,maxRows:15,placeholder:"How were lectures? Worth/required to go to class? Etc.",className:"selector",onChange:this.inputChangeHandler.bind(this),value:this.state.lectureBox}),n.a.createElement("label",{htmlFor:"miscBox"},"Miscellaneous: "),n.a.createElement(k.a,{id:"miscBox",style:{width:"90%",resize:"none"},minRows:5,maxRows:15,className:"selector",onChange:this.inputChangeHandler.bind(this),value:this.state.miscBox}),n.a.createElement("button",{type:"submit",id:"submitButton",className:this.state.darkMode?"dark-mode":null,onClick:this.onSubmit.bind(this)},"Submit!"),n.a.createElement("div",{style:{minHeight:"20vh"}}))}}]),a}(n.a.Component),j=function(e){Object(f.a)(a,e);var t=Object(v.a)(a);function a(e){var r,n;return Object(d.a)(this,a),r=t.call(this,e),"dark"==localStorage.getItem("theme")?(n=!0,document.documentElement.setAttribute("data-theme","dark")):(n=!1,document.documentElement.setAttribute("data-theme","light")),r.state={isLoading:!0,readMode:!0,reviews:[],darkMode:n},r}return Object(p.a)(a,[{key:"addReview",value:function(e){this.setState((function(t){e.reviewID=t.reviews.length;var a=[].concat(Object(c.a)(t.reviews),[e]);return a.sort((function(e,t){return t.datenum-e.datenum})),{reviews:a}}))}},{key:"readData2",value:function(){var e=this;fetch("./reviews.json").then((function(e){return e.json()})).then((function(t){e.setState({reviews:t,isLoading:!1})}))}},{key:"readData",value:function(){var e=Object(w.a)(l.a.mark((function e(){var t,a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:t=e.sent,window.gapi.client.init({apiKey:t,clientId:"515215863375-ane9fqmjm48innd6mc3fh6l38qihpai0.apps.googleusercontent.com",scope:I}).then((function(){C=window.gapi.auth2.getAuthInstance();var e="https://sheets.googleapis.com/v4/spreadsheets/".concat(R);return window.gapi.client.request({path:e,method:"GET",params:{key:t}})})).then((function(e){var r=e.result.sheets.filter((function(e){return"FRI"!=e.properties.title})),n=Array.from(r,(function(e){return e.properties.title})),s=Array.from(r,(function(e){var a=e.properties.title,r="https://sheets.googleapis.com/v4/spreadsheets/".concat(R,"/values/").concat(a);return window.gapi.client.request({path:r,method:"GET",params:{key:t}})}));Promise.all(s).then((function(e){for(var t=[],r=0,s=0;s<e.length;s++){var o,i=e[s].result.values.slice(2),l=Object(h.a)(i);try{for(l.s();!(o=l.n()).done;){var u=o.value;if(u.length<9){var m=9-u.length;u.push.apply(u,Object(c.a)(Array.from({length:m},(function(){return""}))))}var d={dept:n[s].trim(),coursenum:u[0].trim(),coursename:u[1].trim(),prof:u[2].trim(),date:u[3].trim(),datenum:N(u[3].trim()),difficulty:u[4].trim(),workload:u[5].trim(),lecture:u[6].trim(),misc:u[7].trim(),reviewer:u[8].trim(),reviewID:"rev".concat(r)};t.push(d),r+=1}}catch(p){l.e(p)}finally{l.f()}}t.sort((function(e,t){return t.datenum-e.datenum})),a.setState({reviews:t,isLoading:!1})}),(function(e){console.log(e)}))}),(function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this,t=document.createElement("script");t.src="https://apis.google.com/js/api.js",t.async=!0,t.onload=function(){window.gapi.load("client:auth2",(function(){e.readData()}))},document.body.appendChild(t)}},{key:"toggleDarkMode",value:function(){this.setState((function(e){return e.darkMode?(localStorage.setItem("theme","light"),document.documentElement.setAttribute("data-theme","light")):(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-theme","dark")),{darkMode:!e.darkMode}}))}},{key:"toggleReadMode",value:function(){this.setState((function(e){return{readMode:!e.readMode}}))}},{key:"render",value:function(){var e,t,a=this;return this.state.isLoading?n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"column"},n.a.createElement("h1",null,"Loading..."))):(this.state.readMode?(e=n.a.createElement(M,{reviews:this.state.reviews}),t="Submit a review!"):(e=n.a.createElement(A,{reviews:this.state.reviews,updateReviews:this.addReview.bind(this)}),t="Return to search"),n.a.createElement("div",{className:"App"},n.a.createElement(g.a,{size:32,id:"darkmodeButton",onClick:function(){return a.toggleDarkMode()}}),n.a.createElement("div",{className:"column"},n.a.createElement("h1",null,"DS Course Reviews"),n.a.createElement("button",{id:"rwButton",onClick:function(){return a.toggleReadMode()}},t),e)))}}]),a}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.7124af3b.chunk.js.map